<div class="safe-cracker-container">
  <div class="card">
    <h1 class="title">ğŸ”“ Safe Cracker</h1>
    <p class="subtitle">Enter a 10-digit combination to crack the safe</p>

    <form [formGroup]="safeCrackerForm" (ngSubmit)="onSubmit()" class="form">
      <div class="form-group">
        <label for="combination" class="form-label">
          Safe Combination <span class="required">*</span>
        </label>
        <input
          id="combination"
          type="text"
          formControlName="combination"
          class="form-input"
          placeholder="Enter 10-digit combination (e.g., 0123456789)"
          maxlength="10"
          [class.invalid]="combination?.invalid && combination?.touched"
        />
        
        <div class="validation-messages" *ngIf="combination?.invalid && combination?.touched">
          <p class="error-message" *ngIf="combination?.errors?.['required']">
            âš ï¸ Combination is required
          </p>
          <p class="error-message" *ngIf="combination?.errors?.['pattern']">
            âš ï¸ Combination must be exactly 10 digits (0-9 only)
          </p>
          <p class="error-message" *ngIf="combination?.errors?.['minlength'] || combination?.errors?.['maxlength']">
            âš ï¸ Combination must be exactly 10 digits
          </p>
        </div>

        <div class="input-hint" *ngIf="!combination?.invalid">
          â„¹ï¸ Enter exactly 10 numeric digits
        </div>
      </div>

      <div class="button-group">
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="safeCrackerForm.invalid || isLoading"
        >
          <span *ngIf="!isLoading">ğŸ”“ Crack Safe</span>
          <span *ngIf="isLoading">â³ Cracking...</span>
        </button>
        
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="onReset()"
          [disabled]="isLoading"
        >
          ğŸ”„ Reset
        </button>
      </div>
    </form>

    <!-- Error Message -->
    <div class="alert alert-error" *ngIf="error">
      <p>âŒ {{ error }}</p>
    </div>

    <!-- Real-time Progress Display -->
    <div class="progress-card" *ngIf="isLoading && currentProgress">
      <h2 class="progress-title">ğŸ” Cracking in Progress...</h2>
      
      <div class="progress-stats">
        <div class="progress-item">
          <div class="progress-label">Current Attempts</div>
          <div class="progress-value attempts-counter">{{ currentAttempts }}</div>
        </div>
        
        <div class="progress-item">
          <div class="progress-label">Testing Combination</div>
          <div class="progress-value combination-display">{{ currentProgress.current_attempt }}</div>
        </div>
        
        <div class="progress-item">
          <div class="progress-label">Correct Digits</div>
          <div class="progress-value">
            {{ currentProgress.correct_digits }} / {{ currentProgress.total_digits }}
          </div>
        </div>
      </div>
      
      <div class="progress-bar-container">
        <div 
          class="progress-bar" 
          [style.width.%]="(currentProgress.correct_digits / currentProgress.total_digits) * 100"
        ></div>
      </div>
      
      <div class="progress-info">
        <p>âš¡ Real-time updates every 10 attempts</p>
      </div>
    </div>

    <!-- Results Display -->
    <div class="results-card" *ngIf="result">
      <h2 class="results-title">âœ… Safe Cracked Successfully!</h2>
      
      <div class="results-grid">
        <div class="result-item">
          <div class="result-label">Total Attempts</div>
          <div class="result-value">{{ result.attempts }}</div>
        </div>
        
        <div class="result-item">
          <div class="result-label">Time Taken</div>
          <div class="result-value">{{ result.time_taken }} ms</div>
        </div>
      </div>

      <div class="results-info">
        <p>
          <strong>Efficiency:</strong> The algorithm cracked your safe in 
          <strong>{{ result.attempts }}</strong> attempts in just 
          <strong>{{ result.time_taken }}</strong> milliseconds!
        </p>
        <p class="info-text">
          ğŸ’¡ Our intelligent digit-by-digit algorithm is significantly faster 
          than brute force, which would take up to 10 billion attempts!
        </p>
      </div>
    </div>
  </div>
</div>
