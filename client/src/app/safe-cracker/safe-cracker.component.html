<div class="safe-cracker-container">
  <div class="card">
    <h1 class="title">ğŸ”“ Safe Cracker</h1>
    <p class="subtitle">Enter a 10-digit combination to crack the safe using our intelligent algorithm</p>

    <!-- Quick Action Buttons -->
    <div class="quick-actions">
      <button type="button" class="btn-quick" (click)="useExample('1234567890')" title="Try this example">
        âœ¨ Example: 1234567890
      </button>
      <button type="button" class="btn-quick" (click)="useExample('0000000000')" title="Try all zeros">
        ğŸ¯ Try: 0000000000
      </button>
      <button type="button" class="btn-quick" (click)="generateRandom()" title="Generate random combination">
        ğŸ² Random
      </button>
    </div>

    <form [formGroup]="safeCrackerForm" (ngSubmit)="onSubmit()" class="form">
      <div class="form-group">
        <label for="combination" class="form-label">
          Safe Combination <span class="required">*</span>
        </label>
        <input
          id="combination"
          type="text"
          formControlName="combination"
          class="form-input"
          placeholder="e.g., 1234567890 or try Random ğŸ²"
          maxlength="10"
          [class.invalid]="combination?.invalid && combination?.touched"
        />
        
        <div class="validation-messages" *ngIf="combination?.invalid && combination?.touched">
          <p class="error-message" *ngIf="combination?.errors?.['required']">
            âš ï¸ Combination is required
          </p>
          <p class="error-message" *ngIf="combination?.errors?.['pattern']">
            âš ï¸ Combination must be exactly 10 digits (0-9 only)
          </p>
          <p class="error-message" *ngIf="combination?.errors?.['minlength'] || combination?.errors?.['maxlength']">
            âš ï¸ Combination must be exactly 10 digits
          </p>
        </div>

        <div class="input-hint" *ngIf="!combination?.invalid">
          â„¹ï¸ Enter exactly 10 numeric digits
        </div>
      </div>

      <div class="button-group">
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="safeCrackerForm.invalid || isLoading"
        >
          <span *ngIf="!isLoading">ğŸ”“ Crack Safe</span>
          <span *ngIf="isLoading">â³ Cracking...</span>
        </button>
        
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="onReset()"
          [disabled]="isLoading"
        >
          ğŸ”„ Reset
        </button>
      </div>
    </form>

    <!-- Error Message -->
    <div class="alert alert-error" *ngIf="error">
      <p>âŒ {{ error }}</p>
    </div>

    <!-- Real-time Progress Display -->
    <div class="progress-card" *ngIf="isLoading">
      <h2 class="progress-title">ğŸ” Cracking in Progress...</h2>
      
      <div class="progress-stats" *ngIf="currentProgress">
        <div class="progress-item">
          <div class="progress-label">Current Attempts</div>
          <div class="progress-value attempts-counter">{{ currentAttempts }}</div>
        </div>
        
        <div class="progress-item">
          <div class="progress-label">Testing Combination</div>
          <div class="progress-value combination-display">{{ currentProgress.current_attempt }}</div>
        </div>
        
        <div class="progress-item">
          <div class="progress-label">Correct Digits</div>
          <div class="progress-value">
            {{ currentProgress.correct_digits }} / {{ currentProgress.total_digits }}
          </div>
        </div>
      </div>

      <div class="progress-stats" *ngIf="!currentProgress">
        <div class="progress-item" style="grid-column: 1 / -1;">
          <div class="progress-label">Initializing...</div>
          <div class="progress-value">Starting safe cracking algorithm</div>
        </div>
      </div>
      
      <div class="progress-bar-container" *ngIf="currentProgress">
        <div 
          class="progress-bar" 
          [style.width.%]="(currentProgress.correct_digits / currentProgress.total_digits) * 100"
        ></div>
      </div>

      <div class="progress-bar-container" *ngIf="!currentProgress">
        <div class="progress-bar progress-bar-pulse" style="width: 20%"></div>
      </div>
      
      <div class="progress-info">
        <p *ngIf="currentProgress">âš¡ Real-time updates every 10 attempts</p>
        <p *ngIf="!currentProgress">â³ Waiting for first update...</p>
      </div>
    </div>

    <!-- Results Display -->
    <div class="results-card" *ngIf="result">
      <div class="success-header">
        <h2 class="results-title animate-success">âœ… Safe Cracked Successfully!</h2>
        <div class="celebration">ğŸ‰ ğŸŠ ğŸ‰</div>
      </div>
      
      <div class="results-grid">
        <div class="result-item">
          <div class="result-label">Total Attempts</div>
          <div class="result-value animate-count">{{ result.attempts }}</div>
          <div class="result-sublabel">attempts needed</div>
        </div>
        
        <div class="result-item">
          <div class="result-label">Time Taken</div>
          <div class="result-value animate-count">{{ result.time_taken }}</div>
          <div class="result-sublabel">milliseconds</div>
        </div>
      </div>

      <!-- Efficiency Comparison -->
      <div class="efficiency-card">
        <h3 class="efficiency-title">âš¡ Algorithm Efficiency</h3>
        <div class="efficiency-stats">
          <div class="efficiency-item">
            <span class="efficiency-label">Brute Force Would Take:</span>
            <span class="efficiency-value">{{ getBruteForceAttempts().toLocaleString() }} attempts</span>
          </div>
          <div class="efficiency-item">
            <span class="efficiency-label">Our Algorithm Used:</span>
            <span class="efficiency-value highlight">{{ result.attempts }} attempts</span>
          </div>
          <div class="efficiency-item">
            <span class="efficiency-label">Efficiency:</span>
            <span class="efficiency-value success">{{ getEfficiencyPercentage().toFixed(6) }}% of brute force</span>
          </div>
          <div class="efficiency-item">
            <span class="efficiency-label">Speed Improvement:</span>
            <span class="efficiency-value success">{{ getTimesSaved().toLocaleString() }}x faster! ğŸš€</span>
          </div>
        </div>
      </div>

      <div class="results-info">
        <p>
          <strong>Amazing!</strong> The intelligent digit-by-digit algorithm cracked your safe in 
          <strong>{{ result.attempts }}</strong> attempts in just 
          <strong>{{ result.time_taken }}</strong> milliseconds!
        </p>
        <p class="info-text">
          ğŸ’¡ This approach is <strong>{{ getTimesSaved().toLocaleString() }} times faster</strong> 
          than brute force, which would require checking up to 
          <strong>{{ getBruteForceAttempts().toLocaleString() }}</strong> combinations!
        </p>
      </div>
    </div>
  </div>
</div>
